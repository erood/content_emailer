extends layout


block content
  //if not signed up, show landing page
  //if signed up, show key stats on home page
  if user
    head
      //jquery
      script(src='https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js')
      //moment
      script(src='https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.js')
      //select2
      <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script>
      <link href="../css/select2.min.css" rel="stylesheet">
      script.



        $(document).ready(function() {
          $('.js-example-basic-single_2').select2();

        });

        function update_data() {
          document.getElementById("update-form").submit();
        }


        window.onload = function start(){
          //parse the params_json data attached to User model
          var params_json = document.getElementById("params_json").value;
          var params_json_1 = JSON.parse(params_json);
          

          
          //push the User's desired delivery frequency to the selector element
          var frequency = document.getElementById("frequency");
          frequency.value = params_json_1.user.frequency;
          console.log(params_json_1);
          subreddits_stg = params_json_1.user.subreddits;

          //push the User's desired subreddits to the selector element

          //--Create an array from the comma-separated string from JSON parsed data
          var subreddits_stg_2 = subreddits_stg.split(',');

          //--Loop through array, push to selector box
          $.each(subreddits_stg_2, function (i, item) {
              $('#subreddits').append($('<option>', { 
                  value: item,
                  text: item,
                  selected: true

              }));
              
          });



          };




      link(rel='stylesheet', type='text/css', href='https://cdn.datatables.net/v/bs-3.3.7/jq-2.2.4/dt-1.10.15/b-1.3.1/b-colvis-1.3.1/cr-1.3.3/fc-3.2.2/fh-3.1.2/r-2.1.1/rg-1.0.0/rr-1.2.0/sc-1.4.2/datatables.min.css')      
      .div
        .container
          .row
            .col-md-10-col-md-offset-1(style='text-align:center')
              form.form-horizontal(id='update-form', action='/account/profile', method='POST')
                input(type='hidden', name='_csrf', value=_csrf)
                input(type='hidden', id="params_json", value= JSON.stringify(locals))
                h3(style="padding-top:10px;") Welcome
                p.paragraph(style='font-size:22px;line-height:1.5;color:#71828c;padding-top:5px;') 
                  | Your subreddits

                <select multiple="multiple" class="js-example-basic-single_2" name="subreddits" id="subreddits" style="width:265px;font-size:16px;" >
                  <option value='MMM'>3M Company</option>
                  </select>


                //<input style="text-align:center;width:265px !important;display:inline;padding-left:5px;margin-left:5px;border-radius:4px;height:43px" type='text', name='subreddits', id='subreddits', autofocus, required class="form-control" >

                <br>
                <br>
                p.paragraph(style='font-size:22px;line-height:1.5;color:#71828c;padding-top:5px;') 
                  | Your frequency
                <input style="text-align:center;width:265px !important;display:inline;padding-left:5px;margin-left:5px;border-radius:4px;height:43px" type='text', name='frequency', id='frequency', autofocus, required class="form-control" >
   
              <br>
              <br>
              #signup_button2.btn.btn-md.btn-hover.btn-default(onclick='update_data()') Update






      br
      br

      //google analytics - find-me
      script.
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-105691246-1', 'auto');
        ga('send', 'pageview');

        //**************************************************************************//
        //********************************SCRIPTS***********************************//
        //**************************************************************************//

        
  else
    if !user
      //jquery
      script(type='text/javascript', src='https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js')
      <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script>
      <link href="../css/select2.min.css" rel="stylesheet">

      script.
        $(document).ready(function() {
            $('.js-example-basic-single').select2();

        });


      
      .div
        .container
          .row
            .col-md-10-col-md-offset-1(style='text-align:center')
              h3(style="padding-top:10px;") Sign-up
              form.form-horizontal(id='signup-form', action='/signup', method='POST')
                input(type='hidden', name='_csrf', value=_csrf)
                p.paragraph(style='font-size:22px;line-height:1.5;color:#71828c;padding-top:5px;') 
                  | Select your favorite subreddits  
                <select multiple="multiple" class="js-example-basic-single" name="subreddits" id="subreddits" style="width:265px;font-size:16px;" >
                  <option value='MMM'>3M Company</option>
                  <option value='ABT'>Abbott Laboratories</option>
                  <option value='ABBV'>AbbVie Inc.</option>
                  <option value='ACN'>Accenture plc</option>
                  <option value='ATVI'>Activision Blizzard</option>
                  <option value='AYI'>Acuity Brands Inc</option>
                  <option value='ADBE'>Adobe Systems Inc</option>
                  <option value='AMD'>Advanced Micro Devices Inc</option>
                  <option value='AAP'>Advance Auto Parts</option>
                  <option value='AES'>AES Corp</option>
                  <option value='AET'>Aetna Inc</option>
                  <option value='AMG'>Affiliated Managers Group Inc</option>
                  <option value='AFL'>AFLAC Inc</option>
                  <option value='A'>Agilent Technologies Inc</option>
                  <option value='APD'>Air Products & Chemicals Inc</option>
                  <option value='AKAM'>Akamai Technologies Inc</option>
                  <option value='ALK'>Alaska Air Group Inc</option>
                  <option value='ALB'>Albemarle Corp</option>
                  <option value='ARE'>Alexandria Real Estate Equities Inc</option>
                  <option value='ALXN'>Alexion Pharmaceuticals</option>
                  <option value='ALGN'>Align Technology</option>
                  <option value='ALLE'>Allegion</option>
                  <option value='AGN'>Allergan, Plc</option>
                  <option value='ADS'>Alliance Data Systems</option>
                  <option value='LNT'>Alliant Energy Corp</option>
                  <option value='ALL'>Allstate Corp</option>
                  <option value='GOOGL'>Alphabet Inc Class A</option>
                  <option value='GOOG'>Alphabet Inc Class C</option>
                  <option value='MO'>Altria Group Inc</option>
                  <option value='AMZN'>Amazon.com Inc</option>
                  <option value='AEE'>Ameren Corp</option>
                  <option value='AAL'>American Airlines Group</option>
                </select>

                p.paragraph(style='font-size:22px;line-height:1.5;color:#71828c;') 
                  <br>
                  | Select your delivery frequency  
                <select name="frequency" id="frequency" style="width:265px;font-size:16px;padding-top:10px;padding-bottom:10px;height:43px;border-radius:4px !important;line-height:1.7 !important;box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075) !important;border: 1px solid #ccc !important;padding-left:5px;font-family: Avenir !important;" >
                <option value="Daily">Daily</option>
                <option value="Weekly">Weekly</option>
                <option value="Monthly">Monthly</option>
                </select>
                p.paragraph(style='font-size:22px;line-height:1.5;color:#71828c;') 
                  <br>
                  | Enter your email    
                
                <input style="text-align:center;width:265px !important;display:inline;padding-left:5px;margin-left:5px;border-radius:4px;height:43px" type='email', name='email', id='email', placeholder='Email', autofocus, required class="form-control" >

                p.paragraph(style='font-size:22px;line-height:1.5;color:#71828c;') 
                  <br>
                  | Enter your password    
                
                <input style="text-align:center;width:265px !important;display:inline;padding-left:5px;margin-left:5px;border-radius:4px;height:43px" type='password', name='password', id='password', placeholder='Password' class="form-control" >
            
              <br>
              <br>

              #signup_button2.btn.btn-md.btn-hover.btn-default(onclick='signup()') Sign up

              
            
 

          // End mc_embed_signup  
      //.background_image(style='background-image: url(/800_600_background.png);height:100%;background-repeat: no-repeat;padding-top:-100px;background-size:100%')  
      //p.paragraph(style='font-size:20px;line-height:1.5;color:#71828c;')
        br
        span Creators
        br
        | Want to be added to our site?
        br
        | Submit your info
      //#signup_button.btn.btn-md.btn-hover.btn-default(onclick="location.href='/records'") Get started



      script.
        function signup() {
        document.getElementById("signup-form").submit();
        }



        window.onload = function start(){
        //allow submitting with enter key - Signup Form
        $('#signup-form').keydown(function(e) {
        var key = e.which;
        if (key == 13) {
        // As ASCII code for ENTER key is "13"
        document.getElementById("signup-form").submit();
        }
        });
        }
